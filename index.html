<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borkar's Banters</title>
	<script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
</head>
<body class="bg-indigo-100">
    
    <div class="container max-w-2xl mx-auto" >
        <div class="flex flex-col p-4 gap-5" id="posts">
			<div class="rounded bg-indigo-50 p-5 shadow-lg">
				<div class="text-2xl font-sans font-semibold pb-5 text-indigo-900">Borkar's Banters</div>
				<div class="text-gray-600">Take a sneak peek into the life of a young adult embarking on thrilling quests in the realms of endeavor</div>
			</div>
			<div id="warning" class="rounded bg-indigo-50 p-5 shadow-lg justify-center">
				<div class="max-w-xs mx-auto">
					<svg width="20%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="mx-auto stroke-indigo-900">
						<path d="M11 12C11 13.3807 9.88071 14.5 8.5 14.5C7.11929 14.5 6 13.3807 6 12C6 10.6193 7.11929 9.5 8.5 9.5C9.88071 9.5 11 10.6193 11 12Z" stroke-width="1.5"/>
						<path d="M11 12H15.5M15.5 12H17C17.5523 12 18 12.4477 18 13V14M15.5 12V13.5" stroke-width="1.5" stroke-linecap="round"/>
						<path d="M22 12C22 16.714 22 19.0711 20.5355 20.5355C19.0711 22 16.714 22 12 22C7.28595 22 4.92893 22 3.46447 20.5355C2 19.0711 2 16.714 2 12C2 7.28595 2 4.92893 3.46447 3.46447C4.92893 2 7.28595 2 12 2C16.714 2 19.0711 2 20.5355 3.46447C21.5093 4.43821 21.8356 5.80655 21.9449 8"  stroke-width="1.5" stroke-linecap="round"/>
					</svg>
				</div>
				<div class="text-gray-600 text-center py-5">
					In order to continue â€” verify yourself!
				</div>
				<div class="mx-auto text-center">
					<button class="px-4 py-2 font-semibold text-sm bg-indigo-500 text-white rounded-full shadow-sm">Verify</button>
				</div>
			</div>
			<!-- New post template -->
			<!-- <div class="rounded bg-indigo-50 p-5 shadow-lg">
				<div class="text-xs text-slate-400 pb-2">9th July 2023</div>
				<div class="text-lg font-semibold pb-5 text-indigo-900"> The day full of code</div>
				<div class="text-slate-600 text-justify leading-relaxed">
					Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Quisque non tellus orci ac auctor augue mauris augue neque. Vitae tortor condimentum lacinia quis vel eros donec. At erat pellentesque adipiscing commodo elit at. Adipiscing at in tellus integer. Nunc non blandit massa enim nec dui. Malesuada fames ac turpis egestas integer eget aliquet nibh praesent. Eu non diam phasellus vestibulum lorem sed risus ultricies. Lobortis scelerisque fermentum dui faucibus in ornare quam viverra orci. Ornare arcu dui vivamus arcu felis bibendum. Ornare aenean euismod elementum nisi quis eleifend quam adipiscing.
					<br>
					Orci porta non pulvinar neque laoreet suspendisse interdum consectetur. Facilisis gravida neque convallis a cras semper. Praesent tristique magna sit amet purus. Tristique senectus et netus et malesuada. Ipsum suspendisse ultrices gravida dictum fusce ut placerat orci nulla. Porttitor lacus luctus accumsan tortor. Est sit amet facilisis magna etiam. Neque aliquam vestibulum morbi blandit cursus risus at. Nisl rhoncus mattis rhoncus urna neque viverra. Enim ut sem viverra aliquet. Neque ornare aenean euismod elementum nisi quis eleifend quam adipiscing. Libero volutpat sed cras ornare. Et magnis dis parturient montes.
					<br>
					Faucibus et molestie ac feugiat. Quis viverra nibh cras pulvinar. Cursus turpis massa tincidunt dui ut. Quam pellentesque nec nam aliquam sem et. Dictum sit amet justo donec enim. Etiam tempor orci eu lobortis elementum nibh tellus molestie nunc. Faucibus nisl tincidunt eget nullam non nisi est. Praesent elementum facilisis leo vel fringilla est ullamcorper. Non pulvinar neque laoreet suspendisse interdum consectetur libero id faucibus. Amet consectetur adipiscing elit ut. Tellus in metus vulputate eu scelerisque felis. A erat nam at lectus urna. Faucibus scelerisque eleifend donec pretium vulputate sapien nec sagittis aliquam. Massa tincidunt nunc pulvinar sapien. Pellentesque habitant morbi tristique senectus. Aliquet eget sit amet tellus cras. Fermentum dui faucibus in ornare. At risus viverra adipiscing at in tellus integer feugiat scelerisque.
					<br>
					Mi sit amet mauris commodo quis imperdiet massa tincidunt nunc. Bibendum ut tristique et egestas quis ipsum suspendisse ultrices. Pulvinar pellentesque habitant morbi tristique senectus et. Tincidunt id aliquet risus feugiat in ante metus. Id semper risus in hendrerit gravida. Erat imperdiet sed euismod nisi porta lorem mollis. Sed enim ut sem viverra aliquet eget sit amet tellus. Ac odio tempor orci dapibus ultrices in iaculis nunc sed. Et netus et malesuada fames ac turpis. Quis enim lobortis scelerisque fermentum dui faucibus in. Accumsan in nisl nisi scelerisque eu ultrices vitae. Pretium nibh ipsum consequat nisl vel pretium lectus quam. Venenatis urna cursus eget nunc scelerisque viverra mauris in aliquam. Eget mi proin sed libero enim sed faucibus turpis. Eleifend quam adipiscing vitae proin sagittis nisl. Vitae congue mauris rhoncus aenean vel. Eu augue ut lectus arcu bibendum at varius.
					<br>
					Faucibus scelerisque eleifend donec pretium vulputate sapien. Elit eget gravida cum sociis. Lectus sit amet est placerat in egestas erat imperdiet. Elit scelerisque mauris pellentesque pulvinar pellentesque habitant morbi tristique. Risus nullam eget felis eget. Et netus et malesuada fames ac turpis egestas. Pulvinar elementum integer enim neque volutpat ac tincidunt vitae semper. Id nibh tortor id aliquet lectus proin nibh. Lectus arcu bibendum at varius vel pharetra vel turpis. Aliquam malesuada bibendum arcu vitae elementum curabitur. Praesent tristique magna sit amet purus gravida quis. Suscipit tellus mauris a diam maecenas sed. In pellentesque massa placerat duis ultricies. Urna molestie at elementum eu facilisis sed. Morbi tempus iaculis urna id. Diam vulputate ut pharetra sit amet aliquam id. Et malesuada fames ac turpis. Turpis massa sed elementum tempus egestas sed sed.
				</div>
			</div> -->
		</div>
    </div>
    
    <script src="data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/node-forge@1.0.0/dist/forge.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        let currKey = localStorage.getItem('key');
        let currCount = localStorage.getItem('count');

		verifyUser = ()=>{
			//window.location.href = "https://sites.google.com/view/borkarsbanter";
		}

		if(currKey == NaN || currCount == NaN){
			verifyUser();
		}else if(currCount != posts.length){
			verifyUser();
		}else {
			$("#warning").hide()
		}

		

        hexStringToByteString = (hexString) => {
			if (hexString.length % 2 !== 0) {
				throw "Must have an even number of hex digits to convert to bytes";
			}
			var numBytes = hexString.length / 2;
			var byteArray = new Uint8Array(numBytes);
			for (var i=0; i<numBytes; i++) {
				byteArray[i] = parseInt(hexString.substr(i*2, 2), 16);
			}
			return String.fromCharCode.apply(null, byteArray);
		}

		genKey = (times) =>{
			var key = hexStringToByteString(currKey);
			for(var i = 0; i < times; i++){
				var md = forge.md.sha256.create();
				md.update(key);
				key = md.digest().data;
			}
			
			return key;
		}
		
		
		decryptIt = (string, times) => {
			var key = genKey(times);
			var decipher = forge.cipher.createDecipher('AES-CBC', key);
			var encrypted_hex = string;
			var encrypted = hexStringToByteString(encrypted_hex)
			decipher.start({iv: key.slice(0,16)});
			decipher.update(forge.util.createBuffer(encrypted));
			var result = decipher.finish();
			return decipher.output.data;
			
		}

        createPost = (encContent, times) =>{
            var $newPost = $("<div>", {"class" : "rounded bg-indigo-50 p-5 shadow-lg"});
			var $timestamp = $("<div>",{"class" : "text-xs text-slate-400 pb-2"});
			var $heading = $("<div>", {"class" : "text-lg font-semibold pb-5 text-indigo-900"});
			var $svg;
			var $content = $("<div>", {"class" : "text-slate-600 text-justify leading-relaxed"});

            
            $timestamp.append(decryptIt(encContent.timestamp,times));
			$heading.append(decryptIt(encContent.heading,times));
			$content.append(decryptIt(encContent.content,times));
			$newPost.append($timestamp);
			$newPost.append($heading);
			$newPost.append($content)
            $('#posts').append($newPost);
            
        }
        let counter = 0;
        posts.forEach(post => {
            createPost(post, counter);
            counter += 1;
        });
    </script>
</body>
</html>